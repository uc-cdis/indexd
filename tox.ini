[tox]
envlist = py27, py36

[testenv]
whitelist_externals= /bin/bash
                     /usr/bin/wget
                     /usr/bin/java
deps= git+https://github.com/uc-cdis/doiclient.git
      git+https://github.com/uc-cdis/dosclient.git
commands=
    wget https://oss.sonatype.org/content/repositories/releases/io/swagger/swagger-codegen-cli/2.3.1/swagger-codegen-cli-2.3.1.jar
    java -jar swagger-codegen-cli-2.3.1.jar generate -i openapis/swagger.yaml -l python -o swagger_client
    bash -ec "cd swagger_client/; python setup.py install; cd .."
    pip install -r requirements.txt
    python setup.py install --force
    pip install -r test-requirements.txt
    py.test {posargs: -lvv tests/}

